tosca_definitions_version: tosca_simple_yaml_1_0
####################
capability_types:
####################

  tosca.capabilities.PhysicalResourceSpecAttributes:
    descripton: Equates to SIDMOdels.ResourceDomain.ResourceSpecificationABE.PhysicalResourceSpecificationABE.PhysicalResourceSpecAttributes
    # No need to use an inheritance tree for this as it contains no inherited attributes. No harm in doing so if it makes sense for automated mapping but for now derive from root
    derived_from: tosca.capabilities.Root
    properties:
      modelNumber:
        type: string
        required: True
      vendorName:
        type: string
        required: True 
    attributes:
    # These are listed as attributes because they are read only; not because they are optional
      skuNumber:
        type: string
        required: False
      partNumber:
        type: string
        required: False

  tosca.capabilities.ComplexQosFeature:
    derived_from: tosca.capabilities.Root
    description: The ComplexQosFeature capability is an example of how a (vendor specific) feature, when included on a Node Type or Template defintion, indicates that the node can implement that feature
    


####################
node_types:
####################
    
  tosca.nodes.SIDModels:
    derived_from: tosca.nodes.Root
    
  tosca.nodes.SIDModels.ResourceDomain:
    derived_from: tosca.nodes.SIDModels
    
  tosca.nodes.SIDModels.ResourceDomain.ResourceABE:
    derived_from: tosca.nodes.SIDModels.ResourceDomain
    
  tosca.nodes.SIDModels.ResourceDomain.ResourceABE.CompoundResourceABE:
    derived_from: tosca.nodes.SIDModels.ResourceDomain.ResourceABE
    
  tosca.nodes.SIDModels.ResourceDomain.ResourceABE.CompoundResourceABE.CompoundResource:
    derived_from: tosca.nodes.SIDModels.ResourceDomain.ResourceABE.CompoundResourceABE
  
  tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource:
    description: Equates to PhysicalResourceSpec in TM Forum Information Model (SID)
    derived_from: tosca.nodes.SIDModels.ResourceDomain.ResourceABE
    # In SID a PhysicalResourceSpec has a 1 : 0..1 releation to PhysicalResourceAttributes
    # To model this in TOSCA we have these choices:
    # 1 use capability
      # We use this option
    # 2 use requirements: - dependency: capability
      # This places a requirement on node instances derived from this spec that they MUST instantiate a node with the capabiliies defined in PhysicalResourceAttributes
      # which is not what we want
    # 3 use requirements: - dependency: node
      # This places a requirement on node instances derived from this spec that they MUST instantiate a node with the type PhysicalResourceAttributes
      # which is not what we want
    # 4 Flatten the SID and add the attributes in this node
      # this validates but
        # loses the fact that if partNumber is present then vendorName must also be present 
        # attributes: 
        #   modelNumber:
        #     type: string
        #     required: false
        #   vendorName:
        #     type: string
        #     required: true
        #   skuNumber:
        #     type: string
        #     required: false
        #   partNumber:
        #     type: string
        #   required: true
    # 5 Make two node defintions, one with and one without the extension
      # but that doubles the number of child entities
    # 6 Use capability but to a new intermediate node type
      # Does not seem to add anything helpful
    capabilities:
      PhysicalResourceSpecFurtherExtendedBy:
        type: tosca.capabilities.PhysicalResourceSpecAttributes
    
  tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware:
    derived_from: tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource

  tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.PhysicalPort:
    derived_from: tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware
    capabilities:
      link:
        type: tosca.capabilities.network.Linkable
      
  tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.PhysicalPort.Advanced:
    derived_from: tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.PhysicalPort
    capabilities:
      complexQoS:
        type: tosca.capabilities.ComplexQosFeature
      # Other Avanced features may be listed as subsequent capabilities
    requirements:
      - dependency: router_software
      - dependency: port_card
  

  tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.ManagedHardware:
    derived_from: tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware

  tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.ManagedHardware.PhysicalContainer:
    derived_from: tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.ManagedHardware

  tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.ManagedHardware.PhysicalContainer.Equipment:
    derived_from: tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.ManagedHardware.PhysicalContainer

  tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.ManagedHardware.PhysicalContainer.Equipment.Card:
    derived_from: tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.ManagedHardware.PhysicalContainer.Equipment
    

  tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.ManagedHardware.PhysicalContainer.EquipmentHolder:
    derived_from: tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.ManagedHardware.PhysicalContainer

  tosca.nodes.Compute.NetworkDevice:
    derived_from: tosca.nodes.Compute
    description: provides level of indirection between SoftwareComponent and Processor-card
    requirements:
      - dependency: processor_card

  tosca.nodes.CompoundResource:
    derived_from: tosca.nodes.SIDModels.ResourceDomain.ResourceABE.CompoundResourceABE.CompoundResource
    properties:
      property1:
        type: string
      property2:
          type: integer
    attributes:
      attribute1:
        type: float
      attribute2:
        type: boolean

  tosca.nodes.ModularRouter:
    derived_from: tosca.nodes.CompoundResource
    requirements:
      - dependency: router_software
      - dependency: chassis

  tosca.nodes.RouterSoftware:
    derived_from: tosca.nodes.SoftwareComponent
    requirements:
      - host: device_compute

  tosca.nodes.RouterSoftware.Acme:
    derived_from: tosca.nodes.RouterSoftware

  tosca.nodes.RouterSoftware.Acme.Release16:
    derived_from: tosca.nodes.RouterSoftware.Acme
    capabilities:
      ComplexQosFeature:
        type: tosca.capabilities.ComplexQosFeature   


####################
description: Template for physical router within a tosca node.network
topology_template:
####################
  node_templates:

    my_port:
      type: tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.PhysicalPort.Advanced
      # capabilities:
          # linkable is inherited
          # ComplexQoS is defined by type but has no attributes which need value assigment here.


    router_software:
      type: tosca.nodes.RouterSoftware.Acme.Release16

    
            
    device_compute:
      type: tosca.nodes.Compute.NetworkDevice
      capabilities:
        os:
          properties:
            type: timos
            version: "16.0"


    processor_card:
      type: tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.ManagedHardware.PhysicalContainer.Equipment.Card
      capabilities:
        # Including PhysicalResourceSpecFurtherExtendedBy as I want to specifiy the extended properties
        PhysicalResourceSpecFurtherExtendedBy:
          properties:
            # These are mandatory
            modelNumber: "1111"
            vendorName: Acme
          attributes:
            # These are optional and would not normally be specified in a topology template
            #skuNumber: c
            #partNumber: d
      requirements:
        - dependency: slot


    port_card:
      type: tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.ManagedHardware.PhysicalContainer.Equipment.Card
      capabilities:
        # Including PhysicalResourceSpecFurtherExtendedBy as I want to specifiy the extended properties
        PhysicalResourceSpecFurtherExtendedBy:
          properties:
            # These are mandatory
            modelNumber: "1111"
            vendorName: Acme
          attributes:
            # These are optional and would not normally be specified in a topology template
            #skuNumber: c
            #partNumber: d
      requirements:
        - dependency: slot

    slot:
      type: tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.ManagedHardware.PhysicalContainer.EquipmentHolder
      requirements:
        - dependency: chassis

    chassis:
      type: tosca.nodes.SIDModels.ResourceDomain.ResourceABE.PhysicalResource.Hardware.ManagedHardware.PhysicalContainer.Equipment      

    router:
      type: tosca.nodes.ModularRouter
      properties:
        property1: a
        property2: 1
      attributes:
        attribute1: 2.0
        attribute2: true


    
